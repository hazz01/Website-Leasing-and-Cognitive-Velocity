<!DOCTYPE html>
<html lang="english">
  <head>
    <title>Web Leasing and Cognitive Velocity</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    <link rel="stylesheet" href="src/input.css" />
    <link rel="stylesheet" href="output.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" data-tag="font" />

    <style>
      * {
        font-family: Inter;
      }
      .bgbgbg {
        background-image: url("img/Main_BG_Fixed.jpg");
        background-size: cover;
        background-repeat: no-repeat;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        margin: 0;
        padding: 0;
        z-index: -10;
      }
    </style>
  </head>

  <body class="bg-color-main-bg">
    <!-- section -->
    <div class="bgbgbg"></div>
    <section class="max-w-6xl mx-auto mt-32 mb-32 p-10 bg-white rounded-lg">
      <form name="forms_pak_chusni">
        <div class="grid gap-6 mb-6 md:grid-cols-2">
          <div>
            <label for="nama" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Nama (<i>Name</i>) <span class="text-red-600">*</span> </label>
            <input
              type="text"
              name="nama"
              id="nama"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:sbg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 shadow-sm shadow-slate-300/80 focus:shadow-sm focus:shadow-blue-300/100"
              placeholder="Masukkan Nama"
              required
            />
          </div>

          <div>
            <label for="email" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Email <span class="text-red-600">*</span> </label>
            <input
              type="email"
              name="email"
              id="email"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-50 shadow-sm shadow-slate-300/80 focus:shadow-sm focus:shadow-blue-300/100"
              placeholder="Masukkan Email"
              required
            />
          </div>

          <div>
            <label for="umur" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Umur (<i>Age</i>) <span class="text-red-600">*</span> </label>
            <input
              type="number"
              name="umur"
              id="umur"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 shadow-sm shadow-slate-300/80 focus:shadow-sm focus:shadow-blue-300/100"
              placeholder="Masukkan Umur"
              required
            />
          </div>
          <div>
            <label for="gender" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Gender <span class="text-red-600">*</span> </label>
            <input
              type="text"
              name="gender"
              id="gender"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 shadow-sm shadow-slate-300/80 focus:shadow-sm focus:shadow-blue-300/100"
              placeholder="Laki-laki / Perempuan"
              required
            />
          </div>
        </div>
        <div class="mb-6">
          <label for="studi" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Program Studi (<i>Department</i>) <span class="text-red-600">*</span> </label>
          <input
            type="text"
            name="program_studi"
            id="studi"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 shadow-sm shadow-slate-300/80 focus:shadow-sm focus:shadow-blue-300/100"
            placeholder="Masukkan Program Studi"
            required
          />
        </div>

        <div class="mb-6">
          <label for="universitas" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Asal Universitas (<i>University</i>) <span class="text-red-600">*</span> </label>
          <input
            type="text"
            name="asal_universitas"
            id="universitas"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 shadow-sm shadow-slate-300/80 focus:shadow-sm focus:shadow-blue-300/100"
            placeholder="Masukkan Asal Universitas"
            required
          />
        </div>
        <div>
          <label for="IPK" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Indeks Prestasi Kumulatif (IPK/GPA) <span class="text-red-600">*</span> </label>
          <input
            type="number"
            name="IPK"
            id="IPK"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 shadow-sm shadow-slate-300/80 focus:shadow-sm focus:shadow-blue-300/100"
            placeholder="Masukkan IPK"
            pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}"
            required
          />
        </div>
        <div class="flex justify-end">
          <button
            type="submit"
            onclick="saveAnswer();javascript:history.forward()"
            class="btn-kirim text-white bg-primary-color hover:bg-indigo-600 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-primary-color dark:hover:bg-indigo-600 dark:focus:ring-blue-800 mt-5"
          >
            Selanjutnya
          </button>
        </div>
      </form>
    </section>

    <!-- <script src="../path/to/flowbite/dist/flowbite.min.js"></script> -->
    <script type="module">
      // Import the functions you need from the SDKs you need
      // INITIAL: import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries

      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-app.js";
      import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-database.js";

      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBH5qtL-B41AXl3hm5ywcK6UcrWOxzKJb0",
        authDomain: "web-leasing-cognitife-velocity.firebaseapp.com",
        databaseURL: "https://web-leasing-cognitife-velocity-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "web-leasing-cognitife-velocity",
        storageBucket: "web-leasing-cognitife-velocity.appspot.com",
        messagingSenderId: "759615616067",
        appId: "1:759615616067:web:6dbfe6a0b7bc5d5cc550f6",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);
      const webOpenRef = ref(database, "Website/Open");
      console.log("webOpen:", webOpenRef);

      // Mendengarkan perubahan nilai pada path 'Website/Open'
      onValue(webOpenRef, (snapshot) => {
        const webOpenValue = snapshot.val();
        console.log("Nilai terbaru dari Website/Open:", webOpenValue);

        // Di sini, Anda dapat melakukan sesuatu dengan nilai boolean dari 'Website/Open'
        // Misalnya:
        if (webOpenValue) {
          console.log("Website terbuka!");
        } else {
          console.log("Website tertutup!");
          window.location.href = "frame-group-1/closed.html";
        }
      });
    </script>

    <script>
      // const fetch = require("node-fetch");

      // const deploymentId = "AKfycbwUVdBgiVO02UDiyfUH00aw-r5VNTSMrOApONVAAn_LbUXqQJdn9tT6WAagbXF-ehjg";
      // const url = `https://script.google.com/macros/s/${deploymentId}/exec`;

      // async function getValueClose() {
      //   try {
      //     // Perform the first fetch
      //     const response1 = await fetch(url, { method: "HEAD" });
      //     const redirectUrl = response1.headers.get("location");
      //
      //     if (redirectUrl) {
      //       // Perform the second fetch
      //       const response2 = await fetch(redirectUrl);
      //       const data = await response2.json();
      //
      //       // Redirect based on data.status
      //       if (data.status == false) {
      //         console.log("Redirecting to ./closed.html");
      //         window.location.href = "./closed.html"; // Modify this line
      //       } else {
      //         console.log("Redirecting to index.html");
      //         window.location.href = "./index.html"; // Modify this line
      //       }
      //     } else {
      //       console.error("No redirect URL found");
      //     }
      //   } catch (error) {
      //     console.error("Error:", error.message);
      //   }
      // }
      //
      // getValueClose();

      function loadAnswers() {
        const session = sessionStorage.getItem("FormData");
        if (session) {
          const sessionObject = JSON.parse(session);
          for (var question in sessionObject) {
            const inputs = document.getElementsByName(question);
            if (inputs) {
              inputs[0].value = sessionObject[question];
            }
          }
        }
      }

      loadAnswers();
      const scriptURL = "https://script.google.com/macros/s/AKfycbwUVdBgiVO02UDiyfUH00aw-r5VNTSMrOApONVAAn_LbUXqQJdn9tT6WAagbXF-ehjg/exec";
      const form = document.forms["forms_pak_chusni"];

      // form.addEventListener("submit", async (e) => {
      //   e?.preventDefault();
      //   let formData = new FormData(form);
      //   const value = Object.fromEntries(formData.entries());
      //   var json = JSON.stringify(value);
      //   sessionStorage.setItem("FormData", json);
      //   window.location.href = "frame-group-1/frame2.html";
      // });

      form.addEventListener("submit", saveAnswer);
      function saveAnswer(e) {
        e.preventDefault();

        let tempStorage = JSON.parse(sessionStorage.getItem("FormData"));
        let formData = new FormData(form);
        let object = Object.fromEntries(formData.entries());
        tempStorage = { ...tempStorage, ...object };
        sessionStorage.setItem("FormData", JSON.stringify(tempStorage));

        window.location.href = "frame-group-1/frame!_value.html";
      }
    </script>
  </body>
</html>
